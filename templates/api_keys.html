<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Keys - MockFlow.ai</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="/static/modals.css">
    <style>
        body {
            min-height: 100vh;
        }

        .page-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem 2rem 2rem;
        }

        .keys-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1.5rem;
            margin-top: 1rem;
        }

        .keys-section {
            background: white;
            border: 1px solid rgba(26, 26, 26, 0.08);
            border-radius: 12px;
            padding: 1.75rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .info-section {
            background: linear-gradient(135deg, rgba(129, 199, 132, 0.08) 0%, rgba(129, 199, 132, 0.03) 100%);
            border: 1px solid rgba(129, 199, 132, 0.2);
            border-radius: 12px;
            padding: 1.75rem;
            display: flex;
            flex-direction: column;
        }

        .status-badge {
            background: white;
            border: 1px solid rgba(129, 199, 132, 0.3);
            border-radius: 8px;
            padding: 0.625rem 1rem;
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8125rem;
        }

        .status-label {
            font-weight: 600;
            color: var(--success, #81c784);
        }

        .status-content {
            color: var(--text-secondary, #4a4a4a);
        }

        .section-title {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 1.25rem;
            padding-bottom: 0.75rem;
            border-bottom: 2px solid rgba(26, 26, 26, 0.08);
            color: var(--text-primary, #1a1a1a);
        }

        .info-section .section-title {
            border-bottom-color: rgba(129, 199, 132, 0.2);
            color: var(--success, #81c784);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary, #1a1a1a);
        }

        .required {
            color: #ef5350;
            font-weight: 700;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1.5px solid rgba(26, 26, 26, 0.12);
            border-radius: 8px;
            font-size: 0.875rem;
            font-family: 'Inter', sans-serif;
            transition: all 0.2s ease;
            background: var(--bg-secondary, #fafafa);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary, #81c784);
            background: white;
            box-shadow: 0 0 0 3px rgba(129, 199, 132, 0.1);
        }

        .form-input::placeholder {
            color: #999;
            font-size: 0.8125rem;
        }

        .form-help {
            margin-top: 0.375rem;
            font-size: 0.75rem;
            color: var(--text-muted, #666);
            display: flex;
            align-items: center;
            gap: 0.375rem;
        }

        .form-help a {
            color: var(--primary, #81c784);
            text-decoration: none;
            font-weight: 500;
        }

        .form-help a:hover {
            text-decoration: underline;
        }

        .info-content {
            flex: 1;
        }

        .info-block {
            margin-bottom: 1.25rem;
        }

        .info-block h4 {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.625rem;
            color: var(--text-primary, #1a1a1a);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .info-block p {
            font-size: 0.8125rem;
            line-height: 1.6;
            color: var(--text-secondary, #4a4a4a);
            margin-bottom: 0.5rem;
        }

        .info-block ul {
            margin-left: 1.25rem;
            font-size: 0.8125rem;
            line-height: 1.6;
            color: var(--text-secondary, #4a4a4a);
        }

        .info-block ul li {
            margin-bottom: 0.25rem;
        }

        .info-block ul li strong {
            color: var(--text-primary, #1a1a1a);
            font-weight: 600;
        }

        .button-row {
            display: flex;
            gap: 1rem;
            margin-top: 1.25rem;
            padding-top: 1.25rem;
            border-top: 1px solid rgba(129, 199, 132, 0.2);
        }

        .btn-primary,
        .btn-secondary {
            flex: 1;
            padding: 0.875rem 1.5rem;
            font-size: 0.9375rem;
            font-weight: 600;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
        }

        .btn-primary {
            background: var(--primary, #81c784);
            color: white;
        }

        .btn-primary:hover {
            background: #66bb6a;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(129, 199, 132, 0.3);
        }

        .btn-secondary {
            background: white;
            color: var(--text-primary, #1a1a1a);
            border: 1.5px solid rgba(26, 26, 26, 0.15);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary, #fafafa);
            border-color: rgba(26, 26, 26, 0.25);
        }

        @media (max-width: 1200px) {
            .keys-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .page-wrapper {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="auth-header">
        <a href="/dashboard" class="auth-btn">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            <span>Back to Dashboard</span>
        </a>
    </div>

    <div class="action-buttons">
        <button onclick="window.DeveloperModal.open()" class="action-btn" title="About Developer">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="16" x2="12" y2="12"/>
                <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
        </button>
        <a href="https://github.com/PranavMishra17/MockFlow-AI" target="_blank" rel="noopener" class="action-btn action-btn-primary" title="View on GitHub">
            <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.840 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.430.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
        </a>
    </div>

    <div class="page-wrapper">
        <form id="apiKeysForm">
            <div class="keys-grid">
                <div class="keys-section">
                    <h3 class="section-title">LiveKit Credentials</h3>
                    <div class="form-group">
                        <label class="form-label">LiveKit URL<span class="required">*</span></label>
                        <input type="text" id="livekitUrl" class="form-input" placeholder="wss://your-project.livekit.cloud" required>
                        <p class="form-help">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                <polyline points="15 3 21 3 21 9"/>
                                <line x1="10" y1="14" x2="21" y2="3"/>
                            </svg>
                            <a href="https://cloud.livekit.io/" target="_blank">Get from LiveKit Cloud</a>
                        </p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">LiveKit API Key<span class="required">*</span></label>
                        <input type="text" id="livekitApiKey" class="form-input" placeholder="APIxxxxxxxxxx" required>
                        <p class="form-help">Find in LiveKit Dashboard - API Keys</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">LiveKit API Secret<span class="required">*</span></label>
                        <input type="password" id="livekitApiSecret" class="form-input" placeholder="..." required>
                        <p class="form-help">Find in LiveKit Dashboard - API Keys</p>
                    </div>
                </div>

                <div class="keys-section">
                    <h3 class="section-title">AI Service Keys</h3>
                    <div class="form-group">
                        <label class="form-label">OpenAI API Key<span class="required">*</span></label>
                        <input type="password" id="openaiKey" class="form-input" placeholder="sk-proj-..." required>
                        <p class="form-help">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                <polyline points="15 3 21 3 21 9"/>
                                <line x1="10" y1="14" x2="21" y2="3"/>
                            </svg>
                            <a href="https://platform.openai.com/api-keys" target="_blank">Get from OpenAI Platform</a>
                        </p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Deepgram API Key<span class="required">*</span></label>
                        <input type="password" id="deepgramKey" class="form-input" placeholder="..." required>
                        <p class="form-help">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                <polyline points="15 3 21 3 21 9"/>
                                <line x1="10" y1="14" x2="21" y2="3"/>
                            </svg>
                            <a href="https://console.deepgram.com/" target="_blank">Get from Deepgram Console</a>
                        </p>
                    </div>
                </div>

                <div class="info-section">
                    <div class="status-badge">
                        <span class="status-label">Status:</span>
                        <span id="keysStatus" class="status-content">Loading...</span>
                    </div>

                    <h3 class="section-title">Security & Limits</h3>
                    
                    <div class="info-content">
                        <div class="info-block">
                            <h4>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                </svg>
                                Secure Storage
                            </h4>
                            <p>Your API keys are encrypted using Fernet (symmetric encryption based on AES-128-CBC with HMAC) before being stored in our Supabase database. Keys are encrypted at the application layer, meaning they are already encrypted before reaching the database. We never store or transmit keys in plain text.</p>
                        </div>

                        <div class="info-block">
                            <h4>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <line x1="12" y1="16" x2="12" y2="12"/>
                                    <line x1="12" y1="8" x2="12.01" y2="8"/>
                                </svg>
                                Free Tier Limits
                            </h4>
                            <ul>
                                <li><strong>LiveKit:</strong> 10,000 participant minutes/month</li>
                                <li><strong>OpenAI:</strong> $5-$18 free credit</li>
                                <li><strong>Deepgram:</strong> $200 free credit</li>
                            </ul>
                            <p>Monitor usage in dashboards to avoid charges.</p>
                        </div>

                        <div class="info-block">
                            <h4>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                                </svg>
                                BYOK Model
                            </h4>
                            <p>You maintain full control over API usage and costs. We never use your keys for any other purpose.</p>
                        </div>
                    </div>

                    <div class="button-row">
                        <button type="button" onclick="testKeys()" class="btn-secondary">Test Keys</button>
                        <button type="submit" id="saveBtn" class="btn-primary">Save Keys</button>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <div id="messageModal" class="modal-overlay" style="display: none;">
        <div class="modal-container" style="max-width: 400px;">
            <div class="modal-header">
                <h2 id="modalTitle" class="modal-title"></h2>
                <button class="modal-close" onclick="closeModal()" aria-label="Close">&times;</button>
            </div>
            <div class="modal-content">
                <p id="modalMessage" style="color: var(--text-secondary);"></p>
            </div>
            <div class="modal-footer">
                <button onclick="closeModal()" class="modal-btn">OK</button>
            </div>
        </div>
    </div>

    <div id="developerModal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">About the <span class="highlight">Developer</span></h2>
                <button class="modal-close" aria-label="Close">&times;</button>
            </div>
            <div class="modal-content">
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
                    MockFlow.ai is built by developers passionate about helping candidates prepare for technical interviews.
                </p>
            </div>
        </div>
    </div>

    <script src="/static/auth.js"></script>
    <script src="/static/modal.js"></script>
    <script src="/static/apikeys.js"></script>
</body>
</html>